{% extends "base.html" %}
{% load static %}


{% block title %}{{book.name_block|safe}}{% endblock %}
{% block description %}{{book.name_block|safe}}{% endblock %}

{% block og_title %}{{book.name_block|safe}}{% endblock %}
{% block og_description %}{{book.name_block|safe}}{% endblock %}

{% block og_url %}{{ request.build_absolute_uri }}{% endblock %}
{% block image_src %}{% if book.image %}/media/{{book.image|safe}}{% else %}/media/zaglavka.png{% endif %}{% endblock %}
{% block og_image %}{% if book.image %}/media/{{book.image|safe}}{% else %}/media/zaglavka.png{% endif %}{% endblock %}


{% block canonical %}{% if request.is_secure %}https://{% else %}http://{% endif %}{{ request.get_host }}{{ book.get_absolute_url }}{% endblock %}


{% block content %}
{% include "header.html" %}

<style>
	.line {
    display: flex;
}

.line p{
	padding: 0 5px;
}

</style>

<link href="/media/bootstrap-datetimepicker.min.css" type="text/css"
	rel="stylesheet" media="screen">
<script src="/media/moment.min.js" type="text/javascript"></script>
<script src="/media/moment-with-locales.min.js"
	type="text/javascript"></script>
<script src="/media/bootstrap-datetimepicker.min.js"
	type="text/javascript"></script>

<div class="wrap-breadcrumb parallax-breadcrumb">
	<div class="container"></div>
</div>

<div class="container">

	<div class="row">

		{% include "left.html" %}

		<div id="content" class="col-sm-9 productpage">
			<ul class="breadcrumb">

				<li><a href="/"><i class="fa fa-home"></i></a></li>

				<li><a href="{{book.book_cat.get_absolute_url}}">{{book.book_cat.name_block}}</a></li>
				
				<li>{{book.name_block}}</li>

			</ul>














<!--  -->



<div class="row">
	<div class="col-sm-6 product-left">
		<div class="product-info">
			<div class="left product-image thumbnails">

				<!-- Codezeel Cloud-Zoom Image Effect Start -->
				<div class="image"><a class="thumbnail"
						href="/media/{{book.image}}"><img
							id="tmzoom"
							src="{{book.get_img_tovar_thumbnail3}}"
							data-zoom-image="{{book.get_img_tovar_thumbnail3}}"
							title="{{book_name_block}}" alt="{{book_name_block}}"></a>
						
				
				</div>


				<div class="additional-carousel">
					<div class="customNavigation">
						<a class="fa prev fa-arrow-left">&nbsp;</a>
						<a class="fa next fa-arrow-right">&nbsp;</a>
					</div>

					<div id="additional-carousel" class="image-additional product-carousel">
						


								<div class="slider-item first_item_cz" style="width: 100px;">
									<div class="product-block" style="height: 115px;">
										<a href="/media/{{book.image}}"
											title="{{book_name_block}}" class="elevatezoom-gallery"
											data-image="{{book.get_img_tovar_thumbnail3}}"
											data-zoom-image="{{book.get_img_tovar_thumbnail3}}"><img
												src="{{book.get_img_tovar_thumbnail3}}"
												width="85" height="115" title="{{book_name_block}}"
												alt="{{book_name_block}}"></a>
									</div>
								</div>

								{% if book.get_img_tovar_thumbnail4 %}
								<div class="slider-item" style="width: 100px;">
									<div class="product-block" style="height: 115px;">
										<a href="/media/{{book.image2}}" title="{{book_name_block}} фото-2" class="elevatezoom-gallery"
											data-image="{{book.get_img_tovar_thumbnail4}}" data-zoom-image="{{book.get_img_tovar_thumbnail4}}"><img
												src="{{book.get_img_tovar_thumbnail4}}" width="85" height="115" title="{{book_name_block}} фото-2"
												alt="{{book_name_block}} фото-2"></a>
									</div>
								</div>
								{% endif %}




								


								









					</div>
					<span class="additional_default_width" style="display: none; visibility: hidden;"></span>
				</div>


				<!-- Codezeel Cloud-Zoom Image Effect End-->
			</div>
		</div>
	</div>

	<div class="col-sm-6 product-right">

		<h3 class="product-title">
			
				{{book.name_block}}
			
		</h3>




		<div class="rating-wrapper">
			<span class="fa fa-stack">
				{% if rayting_sr.rayting_seredina__avg >= 0.6 %}
				<i class="fa fa-star fa-stack-1x"></i>
				{% endif %}
				<i
					class="fa fa-star-o fa-stack-1x"></i></span>
					
			<span class="fa fa-stack">
				{% if rayting_sr.rayting_seredina__avg >= 1.6 %}
				<i
					class="fa fa-star fa-stack-1x"></i>
					{% endif %}
					<i class="fa fa-star-o fa-stack-1x"></i></span>
					
			<span
				class="fa fa-stack">
				{% if rayting_sr.rayting_seredina__avg >= 2.6 %}
				<i class="fa fa-star fa-stack-1x"></i>
				{% endif %}
				<i
					class="fa fa-star-o fa-stack-1x"></i></span> 
					
			<span class="fa fa-stack">
				{% if rayting_sr.rayting_seredina__avg >= 3.6 %}
				<i
					class="fa fa-star fa-stack-1x"></i>
					{% endif %}
					<i class="fa fa-star-o fa-stack-1x"></i></span> 
					
			<span
				class="fa fa-stack">
				{% if rayting_sr.rayting_seredina__avg >= 4.6 %}
				<i class="fa fa-star fa-stack-1x"></i>
				{% endif %}
				<i
					class="fa fa-star-o fa-stack-1x"></i></span> 
					
					<a href="" class="review-count"
				onclick="$('a[href=\'#tab-review\']').trigger('click'); return false;">
				
				{% if otziv_book %}{{otziv_book|length}} отзыв(а){% else %} 0 отзывов {% endif %}
				
			</a> <a href="" onclick="$('a[href=\'#tab-review\']').trigger('click'); return false;"
				class="write-review"><i class="fa fa-pencil"></i>
				
					Написать отзыв
				
			</a>

		</div>

		<ul class="list-unstyled attr">
			
			<li><span class="desc">
					
						Код продукта:
					
				</span>
				
					 Продукт {{book.id}}
				
			</li>
			{% if book.avtors.all %}
			<li><span class="desc">
					
					Авторы:
					
				</span>
				
					{% for avtor in book.avtors.all %}
					
						{{avtor.full_name}},
					
					{% endfor %}
				
			</li>
			{% endif %}
			
			<li><span class="desc">
					
						Наличие: 
					
				</span>
				
					{% if book.active %}Есть{% else %}Закончились{% endif %}
				
			</li>

		
			<li><span class="desc">
			
					Скачать:
			
				</span>
			
					{% if book.file %}<a style="text-decoration: underline;" href="/media/{{book.file}}">Fb2</a>,{% endif %}
					{% if book.file2 %}<a style="text-decoration: underline;" href="/media/{{book.file2}}">Epub</a>,{% endif %}
					{% if book.file3 %}<a style="text-decoration: underline;" href="/media/{{book.file3}}">Rtf</a>,{% endif %}
					{% if book.file4 %}<a style="text-decoration: underline;" href="/media/{{book.file4}}">Mobi</a>,{% endif %}
			
			</li>
			

		</ul>

		<div id="product">
			<h3 class="product-option">
				
					Доступные Варианты
				
			</h3>
			<div class="form-group required">
				<label class="control-label" for="input-option225">
					
						Дата доставки
					
				</label>
				<div class="input-group date">
					<input type="text" name="option[225]" value="2011-04-22" data-date-format="YYYY-MM-DD"
						id="input-option225" class="form-control">
					<span class="input-group-btn">
						<button class="btn btn-default" type="button"><i class="fa fa-calendar"></i></button>
					</span>
				</div>
			</div>

			<div class="price-cartbox">
				<ul class="list-unstyled price">
					{% if book.procent != 0 %}
					<li>
						<span class="old-price" style="text-decoration: line-through;">
							
							{{book.old_price}} руб
							
						</span>
					</li>
							{% endif %}
					<li>
						<h3 class="special-price">
							
								{{book.price}} руб

							
						</h3>
					</li>
					{% if book.procent != 0 %}
					<li class="price-tax">
						
							Со скидкой: {{book.skidka}} руб
						
					</li>
				{% endif %}
				</ul>


				<div class="form-group qty">
					<label class="control-label" for="input-quantity">
						
							Кол-во
						
					</label>
					<input type="text" name="quantity" value="1" size="2" id="input-quantity" class="form-control">
					<input type="hidden" name="product_id" value="47">

					<button type="button" id="button-cart" data-loading-text="Loading..."
						class="btn btn-primary btn-lg btn-block">
						
							добавить в корзину
						
					</button>
					
				</div>
			</div>

			<!-- AddThis Button BEGIN -->
			<!-- <div class="addthis_toolbox addthis_default_style"
				data-url="https://demo.codezeel.com/opencart/OPC07/OPC070157/index.php?route=product/product&amp;product_id=47">
				<a class="addthis_button_facebook_like" fb:like:layout="button_count"></a> <a
					class="addthis_button_tweet"></a> <a class="addthis_button_pinterest_pinit"></a> <a
					class="addthis_counter addthis_pill_style"></a></div>
			<script type="text/javascript"
				src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-515eeaf54693130e"></script> -->
			<!-- AddThis Button END -->
		</div>
	</div>

	<!-- product page tab code start-->

	<div id="tabs_info" class="product-tab col-sm-12">
		<ul class="nav nav-tabs">

			{% if book.opisanie_full %}
			<li class="active"><a href="#tab-description" data-toggle="tab">
					
						Описание
					
				</a></li>
			{% endif %}

			<li {% if book.opisanie_full %}{% else %}class="active"{% endif %}><a href="#tab-review" data-toggle="tab">
					
						Отзывы ({% if otziv_book %}{{otziv_book|length}}{% else %}0{% endif %})
					
				</a></li>
		</ul>
		<div class="tab-content">


				{% if book.opisanie_full %}
			<div class="tab-pane active" id="tab-description">
				<p>
					
						
							{{book.opisanie_full|safe}}
						
					
				</p>
			</div>
			{% endif %}
			
			<div class="tab-pane {% if book.opisanie_full %}{% else %}active{% endif %}" id="tab-review">










{% if otziv_book.all %}
	{% for otziv_block in otziv_book %}
				
					<div id="review">
						<table class="table table-striped table-bordered">
							<tbody>
								<tr>
									<td style="width: 50%;"><strong>
											
											{{otziv_block.zakazchik}}
											
										</strong></td>
									<td class="text-right">
										
										{{ otziv_block.created_at|date:"j" }} 
										{{ otziv_block.created_at|date:"F" }} 
										{{ otziv_block.created_at|date:" Y "}}
										
									</td>
								</tr>
								<tr>
									<td colspan="2">
										
											
												{% if otziv_block.otziv_plus %}<div class="line"><p><strong>Плюсы:</strong> {{otziv_block.otziv_plus|safe}}</p></div>{% endif %}
												{% if otziv_block.otziv_minus %}<div class="line"><p><strong>Минусы:</strong>{{otziv_block.otziv_minus|safe}}</p></div>{% endif %}
												{% if otziv_block.opisanie %}<div class="line"><p><strong>Комментарий:</strong>{{otziv_block.opisanie|safe}}</p></div>{% endif %}
											
										
										&nbsp;Интересно: &nbsp;
										<span class="fa fa-stack">
											{% if otziv_block.rayting >= 1 %}
											<i class="fa fa-star fa-stack-2x"></i>
											{% endif %}
											<i class="fa fa-star-o fa-stack-2x"></i>
										</span> 
											<span class="fa fa-stack">
												{% if otziv_block.rayting >= 2 %}
												<i class="fa fa-star fa-stack-2x"></i>
												{% endif %}
												<i class="fa fa-star-o fa-stack-2x"></i>
											</span>
											 <span class="fa fa-stack">
												{% if otziv_block.rayting >= 3 %}
												<i class="fa fa-star fa-stack-2x"></i>
												{% endif %}
												<i class="fa fa-star-o fa-stack-2x"></i>
											</span> 
											<span class="fa fa-stack">
												{% if otziv_block.rayting >= 4 %}
												<i class="fa fa-star fa-stack-2x"></i>
												{% endif %}
												<i class="fa fa-star-o fa-stack-2x"></i>
											</span> 
											<span class="fa fa-stack">
												{% if otziv_block.rayting >= 5 %}
												<i class="fa fa-star fa-stack-2x"></i>
												{% endif %}
												<i class="fa fa-star-o fa-stack-2x"></i>
											</span>




										&nbsp;  Цена: &nbsp;
										<span class="fa fa-stack">{% if otziv_block.rayting2 >= 1 %}<i class="fa fa-star fa-stack-2x"></i>{% endif %}<i class="fa fa-star-o fa-stack-2x"></i></span> <span
											class="fa fa-stack">{% if otziv_block.rayting2 >= 2 %}<i class="fa fa-star fa-stack-2x"></i>{% endif %}<i class="fa fa-star-o fa-stack-2x"></i></span> <span
											class="fa fa-stack">{% if otziv_block.rayting2 >= 3 %}<i class="fa fa-star fa-stack-2x"></i>{% endif %}<i class="fa fa-star-o fa-stack-2x"></i></span> <span
											class="fa fa-stack">{% if otziv_block.rayting2 >= 4 %}<i class="fa fa-star fa-stack-2x"></i>{% endif %}<i class="fa fa-star-o fa-stack-2x"></i></span> <span
											class="fa fa-stack">{% if otziv_block.rayting2 >= 5 %}<i class="fa fa-star fa-stack-2x"></i>{% endif %}<i class="fa fa-star-o fa-stack-2x"></i></span>
										&nbsp;  Сюжет: &nbsp;
										<span class="fa fa-stack">{% if otziv_block.rayting3 >= 1 %}<i class="fa fa-star fa-stack-2x"></i>{% endif %}<i class="fa fa-star-o fa-stack-2x"></i></span> <span
											class="fa fa-stack">{% if otziv_block.rayting3 >= 2 %}<i class="fa fa-star fa-stack-2x"></i>{% endif %}<i class="fa fa-star-o fa-stack-2x"></i></span> <span
											class="fa fa-stack">{% if otziv_block.rayting3 >= 3 %}<i class="fa fa-star fa-stack-2x"></i>{% endif %}<i class="fa fa-star-o fa-stack-2x"></i></span> <span
											class="fa fa-stack">{% if otziv_block.rayting3 >= 4 %}<i class="fa fa-star fa-stack-2x"></i>{% endif %}<i class="fa fa-star-o fa-stack-2x"></i></span> <span
											class="fa fa-stack">{% if otziv_block.rayting3 >= 5 %}<i class="fa fa-star fa-stack-2x"></i>{% endif %}<i class="fa fa-star-o fa-stack-2x"></i></span>
									</td>
								</tr>
							</tbody>
						</table>
						<div class="text-right"></div>
					</div>
	{% endfor %}


					{% endif %}


{% if request.user.is_authenticated %}


					<form class="form-horizontal" id="form-review">
						{% csrf_token %}
					<h3>
						
							Написать обзор
						
					</h3>

					<input  type="hidden" name="book_id" value="{{book.id}}">
					<input  type="hidden" name="avtor_id" value="{{request.user.id}}" >
					<input type="hidden" name="otziv_add" value="otziv_add">
				
					<div class="form-group required">
						<div class="col-sm-12">
							<label class="control-label" for="input-review">
								Плюсы
							</label>
							<textarea  name="text" rows="3" id="input-review" class="form-control"></textarea>
							<label class="control-label" for="input-review">
								Минусы
							</label>
							<textarea  name="text2" rows="3" id="input-review" class="form-control"></textarea>
							<label class="control-label" for="input-review">
								Ваш обзор
							</label>
							<textarea  name="text3" rows="3" id="input-review" class="form-control"></textarea>
							
						</div>
					</div>
					<div class="form-group required">
					

						<table style="margin-left: 10px">
							<tr>
								<td>
<label class="control-label" style="padding: 0;">Интерес:</label>
								</td>
								<td>
	&nbsp;&nbsp;&nbsp; Скучно&nbsp;
	
	<input type="radio" name="rating" value="1">
	
	<input type="radio" name="rating" value="2">
	
	<input type="radio" name="rating" value="3">
	
	<input type="radio" name="rating" value="4">
	
	<input type="radio" name="rating" checked value="5">
	
	
	&nbsp;Обалденно
								</td>
							</tr>

														<tr>
															<td>
															<label class="control-label" style="padding: 0;">Цена:</label>
															</td>
															<td>
																&nbsp;&nbsp;&nbsp; Дорого&nbsp;
														
																<input type="radio" name="rating2" value="1">
														
																<input type="radio" name="rating2" value="2">
														
																<input type="radio" name="rating2" value="3">
														
																<input type="radio" name="rating2" value="4">
														
																<input type="radio" name="rating2" checked value="5">
														
														
																&nbsp;Супер
															</td>
														</tr>
<tr>
	<td>
		<label class="control-label" style="padding: 0;">
		
			Сюжет:
		
		</label>
	</td>
	<td>
	&nbsp;&nbsp;&nbsp; Плохой&nbsp;
	
	<input type="radio" name="rating3" value="1">
	
	<input type="radio" name="rating3" value="2">
	
	<input type="radio" name="rating3" value="3">
	
	<input type="radio" name="rating3" value="4">
	
	<input type="radio" name="rating3" checked value="5">
	
	
	&nbsp;Хороший
	</td>
</tr>

						</table>



					</div>

					<div class="buttons clearfix">
						<div class="pull-right">
							<button type="button" id="button-review"  data-loading-text="Loading..."
								class="btn btn-primary">
								
									Отправить
								
							</button>
						</div>
					</div>
				</form>

				{% else %}
				<div class="panel panel-default" id="add-comment">

	<h4 class="text-center">

		Вы должны
		<a style="    color: #e56220;" href="/login/">

			войти

		</a>

		чтобы добавить комментарий. Если у вас нет учетной записи, вы можете

		<a style="    color: #e56220;" href="/register/">

			зарегистрировать

		</a>

		ее. Регистрация бесплатна!

	</h4>

</div>





				{% endif %}






			</div>
		</div>
	</div>
</div>









<div class="box related ">
					
	<div class="box-head">
		<div class="box-heading">
			
				сопутствующие книги
			
		</div>
	</div>


		<div class="box-content">
				
			<div class="customNavigation">
					<a class="fa prev czblog_prev"></a>
					<a class="fa next czblog_next"></a>
				</div>


			
						
			<div class="box-product  owl-carousel blogcarousel " id="blog-carousel">
				 
					{% for book in book_dop %}
					<div class="product-layout product-grid " style="width: 100%">	
					{% include "book_prewie.html" %}
					</div>
					{% endfor %}
				 
				   
			</div>
			
		</div>
</div>



<span class="blog_default_width" style="display:none; visibility:hidden"></span>


<script type="text/javascript">
	document.getElementById("button-review").addEventListener("click", function() {
    let formData = new FormData(document.getElementById("form-review"));
    fetch("{{book.get_absolute_url}}", {
        method: "POST",
        body: formData
    })
    .then(response => response.json())
    .then(data => {
		console.log("Ок");
		window.location.reload();
    })
    .catch(error => {
        console.error("Ошибка:", error);
        alert("Произошла ошибка при отправке отзыва.");
    });
});

</script>




<script type="text/javascript"><!--

$(document).ready(function(){
	$('.blogcarousel').owlCarousel({
		items: 4,
		singleItem: false,
		navigation: false,
		pagination: false,
		itemsDesktop : [1199,2],
		itemsDesktopSmall :	[991,2],
		itemsTablet :	[575,2]
	});
	// Custom Navigation Events
	$(".czblog_next").click(function(){
		$('.blogcarousel').trigger('owl.next');
	})
	$(".czblog_prev").click(function(){
		$('.blogcarousel').trigger('owl.prev');
	});	
});	
--></script>





















			<!--  -->
		</div>
	</div>
</div>









<script type="text/javascript">
$('.date').datetimepicker({
	language: '',
	pickTime: false
});

$('.datetime').datetimepicker({
	language: '',
	pickDate: true,
	pickTime: true
});

$('.time').datetimepicker({
	language: '',
	pickDate: false
});
</script>


<script type="text/javascript"><!--
$('#review').delegate('.pagination a', 'click', function(e) {
    e.preventDefault();

    $('#review').fadeOut('slow');

    $('#review').load(this.href);

    $('#review').fadeIn('slow');
});



$(document).ready(function() {
if ($(window).width() > 767) {
		$("#tmzoom").elevateZoom({
				
				gallery:'additional-carousel',
				//inner zoom				 
								 
				zoomType : "inner", 
				cursor: "crosshair" 
				
				/*//tint
				
				tint:true, 
				tintColour:'#F90', 
				tintOpacity:0.5
				
				//lens zoom
				
				zoomType : "lens", 
				lensShape : "round", 
				lensSize : 200 
				
				//Mousewheel zoom
				
				scrollZoom : true*/
				
				
			});
		var z_index = 0;
     			    		
     			    		$(document).on('click', '.thumbnail', function () {
     			    		  $('.thumbnails').magnificPopup('open', z_index);
     			    		  return false;
     			    		});
			    		
     			    		$('#additional-carousel a').click(function() {
     			    			var smallImage = $(this).attr('data-image');
     			    			var largeImage = $(this).attr('data-zoom-image');
     			    			var ez =   $('#tmzoom').data('elevateZoom');	
     			    			$('.thumbnail').attr('href', largeImage);  
     			    			ez.swaptheimage(smallImage, largeImage); 
     			    			z_index = $(this).index('#additional-carousel a');
     			    			return false;
     			    		});
			
	}else{
		$(document).on('click', '.thumbnail', function () {
		$('.thumbnails').magnificPopup('open', 0);
		return false;
		});
	}
});
$(document).ready(function() {     
	$('.thumbnails').magnificPopup({
		delegate: 'a.elevatezoom-gallery',
		type: 'image',
		tLoading: 'Loading image #%curr%...',
		mainClass: 'mfp-with-zoom',
		gallery: {
			enabled: true,
			navigateByImgClick: true,
			preload: [0,1] 
		},
		image: {
			tError: '<a href="%url%">The image #%curr%</a> could not be loaded.',
			titleSrc: function(item) {
				return item.el.attr('title');
			}
		}
	});
});


//--></script>



<div id="lightboxOverlay" class="lightboxOverlay" style="display: none;"></div>


{% include "footer.html" %}
{% endblock %}